# Packages ---------------------------------------------------------------------
library(dplyr)

# Experimental data analysis

# Load data
data_clean <- readRDS("_SharedFolder_datagotchi-santé/data/clean/datagotchi-sante_clean.rds")
data_raw <- haven::read_sav("_SharedFolder_datagotchi-santé/data/raw/datagotchi_sante/data_raw.sav")  %>% 
  filter(code == "complete")

# Check missing values ---------------------------------------------------------
missing_values <- colSums(is.na(data_clean))
missing_values[missing_values > 0]

# Remove observations without score (because of NA in the questionnaire)
data <- data_clean %>%
  filter(!is.na(data_clean$score_norm))

# Check missing values
missing_values <- colSums(is.na(data))
missing_values[missing_values > 0]

# Aperçu des valeurs pour chaque variable
summary(data)

# Comparaisons variables clean et raw ------------------------------------------
names_clean_r <- names(data_clean)
names_raw_r <- names(data_raw)

names_clean_codebook <- c(
  "ses_genre",
  "ses_sexual_orientation",
  "ses_age",
  "ses_age_group",
  "ses_langue_maternelle",
  "ses_occupation_self_employed",
  "ses_occupation_salaried_work",
  "ses_occupation_retired",
  "ses_occupation_unemployed",
  "ses_occupation_student",
  "ses_occupation_caregiver",
  "ses_occupation_parent",
  "ses_occupation_handicap",
  "ses_occupation_multiple_job_self_employment",
  "ses_occupation_multiple_job_salaried",
  "ses_occupation_unemployed_social_assistance",
  "ses_emploi",
  "ses_travail_management",
  "ses_travail_finance",
  "ses_travail_natural_sciences",
  "ses_travail_health",
  "ses_travail_education_law_government",
  "ses_travail_art_sport",
  "ses_travail_sales_services",
  "ses_travail_trades_transport",
  "ses_travail_transport",
  "ses_travail_manufacturing",
  "ses_travail_other",
  "ses_heures_travail",
  "ses_heures_teletravail",
  "ses_revenu",
  "ses_percep_revenu",
  "ses_education",
  "ses_pays_origine",
  "ses_origines_ethniques",
  "ses_religion",
  "ses_religiosite",
  "ses_enfants",
  "ses_enfants_bin",
  "ses_marital_status",
  "ses_married_bin",
  "ses_single_bin",
  "ses_poids",
  "ses_code_postal",
  "ses_travail_deplacement",
  "ses_urban_rural",
  "ses_habitation",
  "ses_province_",
  "lifestyle_pets",
  "lifestyle_act_physique",
  "lifestyle_freq_physique_",
  "lifestyle_transport",
  "lifestyle_car_model",
  "lifestyle_consumption",
  "lifestyle_coffee",
  "lifestyle_meat",
  "lifestyle_alcool_pref",
  "lifestyle_smoking_freq",
  "lifestyle_cannabis",
  "lifestyle_hunting",
  "lifestyle_fishing",
  "lifestyle_motorized",
  "lifestyle_friends_activity",
  "lifestyle_volunteer",
  "lifestyle_museum",
  "lifestyle_nature_may_september",
  "lifestyle_nature_october_april",
  "lifestyle_movie_pref",
  "lifestyle_style",
  "lifestyle_style_other",
  "lifestyle_music_pref",
  "lifestyle_temps_ecran_semaine_travail",
  "lifestyle_temps_ecran_finsemaine_travail",
  "lifestyle_temps_ecran_semaine_loisir",
  "lifestyle_temps_ecran_finsemaine_loisir",
  "bien_etre_general_health",
  "bien_etre_felt_happy",
  "bien_etre_interested_in_life",
  "bien_etre_satisfied_with_life",
  "bien_etre_important_contribution_society",
  "bien_etre_sense_belonging_community",
  "bien_etre_society_becomes_better_place",
  "bien_etre_people_fundamentally_good",
  "bien_etre_society_makes_sense",
  "bien_etre_like_personality",
  "bien_etre_handling_responsibilities",
  "bien_etre_warm_relationships_with_people",
  "bien_etre_better_person",
  "bien_etre_able_express_opinions",
  "bien_etre_life_has_meaning",
  "bien_etre_pleasure_doing_things",
  "bien_etre_sad",
  "bien_etre_nervous",
  "bien_etre_worries",
  "bien_etre_stress_vie",
  "bien_etre_chronic_problems",
  "bien_etre_asthma",
  "bien_etre_copd",
  "bien_etre_sleep_apnea",
  "bien_etre_fibromyalgia",
  "bien_etre_joint_problems",
  "bien_etre_back_pain",
  "bien_etre_osteoporosis",
  "bien_etre_hypertension",
  "bien_etre_cholesterol_lipids",
  "bien_etre_celiac_disease",
  "bien_etre_instestinal_disease",
  "bien_etre_heart_disease",
  "bien_etre_stroke_disorders",
  "bien_etre_diabetes",
  "bien_etre_cancer",
  "bien_etre_thyroid_problems",
  "bien_etre_alzheimers_dementia",
  "bien_etre_chronic_fatigue",
  "bien_etre_renal_failure",
  "bien_etre_liver_disease",
  "bien_etre_abdomen_ulcers",
  "bien_etre_allergies",
  "comp_sante_focus_attention_present",
  "comp_sante_learn_live_strengths_weaknesses",
  "comp_sante_congratulate_myself_successes",
  "comp_sante_try_love_myself_as_i_am",
  "comp_sante_consider_abilities_make_schedule",
  "comp_sante_find_comfort_people_around_listen",
  "attention_check_ok",
  "comp_sante_do_activities_enjoy_keep_life_active",
  "comp_sante_have_healthy_diet",
  "comp_sante_do_exercises_relax",
  "comp_sante_acknowledge_challenges_difficulties",
  "comp_sante_engage_supportive_comforting_self_talk",
  "comp_sante_remind_failure_challenge_part_human_experience",
  "comp_sante_sleep_quality",
  "comp_sante_chronotype",
  "comp_sante_sleep_pattern_satisfaction",
  "comp_sante_sleep_problem_interfere_daily_functioning",
  "comp_sante_fruit_vegetables_servings",
  "comp_sante_alcohol_freq",
  "comp_sante_cannabis_freq",
  "comp_sante_cannabis_freq_bin",
  "comp_sante_amphetamines_freq",
  "comp_sante_amphetamines_freq_bin",
  "comp_sante_tobacco_freq",
  "comp_sante_tobacco_freq_bin",
  "comp_sante_physical_activity_high_intensity",
  "comp_sante_physical_activity_moderate_intensity",
  "comp_sante_physical_activity_low_intensity",
  "enviro_work_lack_time_for_tasks",
  "enviro_work_one_task_at_a_time",
  "enviro_work_contradictory",
  "enviro_work_heavy_workload",
  "enviro_work_frequently_interrupted",
  "enviro_work_lot_of_responsibility",
  "enviro_work_forced_overtime",
  "enviro_work_objectives_are_clear",
  "enviro_work_physical_effort",
  "enviro_work_became_demanding",
  "enviro_work_require_concentration",
  "enviro_work_workload_too_heavy",
  "enviro_travail_freedom_work",
  "enviro_travail_influence_amount_work",
  "enviro_travail_decide_break",
  "enviro_travail_influence_decisions_work",
  "enviro_travail_influence_do_job",
  "enviro_travail_colleagues_sensitive",
  "enviro_travail_support_from_colleagues",
  "enviro_travail_ask_colleagues_for_help",
  "enviro_travail_task_distributed_fairly",
  "enviro_travail_superior_conflict_resolution",
  "enviro_travail_support_from_superior",
  "enviro_travail_superior_competent_planning",
  "enviro_travail_superior_priority_job_satisfaction",
  "enviro_travail_times_discuss_difficulties",
  "enviro_travail_superior_listens",
  "enviro_travail_superior_work_together",
  "enviro_quartier_safe_bike_paths",
  "enviro_quartier_fresh_fruits_and_vegetables",
  "enviro_quartier_friendly_neighborhood",
  "enviro_quartier_nice_looking_neighborhood",
  "enviro_quartier_accessible_sports_facilities",
  "enviro_quartier_fast_food",
  "enviro_quartier_green_spaces",
  "enviro_quartier_safe_neighborhood",
  "enviro_quartier_places_for_socializing",
  "enviro_quartier_noisy_polluted_neighborhood",
  "quartier_opportunities_health",
  "quartier_satisfaction",
  "service_sante_famille_general",
  "service_sante_specialist",
  "service_sante_nurse_practitioner",
  "service_sante_other",
  "service_sante_none",
  "service_sante_sexual_satisfaction",
  "service_sante_mental_consult",
  "service_sante_mental_famille_general",
  "service_sante_mental_psychiatrist",
  "service_sante_mental_psychologue",
  "service_sante_mental_nurse",
  "service_sante_mental_social_worker",
  "service_sante_mental_other",
  "service_sante_mental_none",
  "service_sante_mental_other_text",
  "valeurs_respect_elders",
  "valeurs_religiosity",
  "valeurs_care_for_others",
  "attention_check_2",
  "valeurs_equal_opportunity_for_everyone",
  "valeurs_curious",
  "valeurs_takes_risks",
  "valeurs_having_fun",
  "valeurs_important_being_successful",
  "valeurs_important_being_in_charge",
  "valeurs_organized",
  "valeurs_extraverted_enthusiastic",
  "valeurs_critical_quarrelsome",
  "valeurs_dependable_self_disciplined",
  "valeurs_anxious_easily_upset",
  "valeurs_open_experiences_complex",
  "valeurs_reserved_quiet",
  "valeurs_sympathetic_warm",
  "valeurs_disorganized_careless",
  "valeurs_calm_emotionally_stable",
  "valeurs_conventional_uncreative",
  "climate_worry_climate_change",
  "climate_worry_future",
  "climate_worry_climate_people",
  "comport_socio_people_count_on",
  "comport_socio_emotional_security",
  "comport_socio_life_decision",
  "comport_socio_skills_relationship",
  "comport_socio_group_beliefs",
  "comport_socio_immediate_friends",
  "comport_socio_friends_dispo",
  "comport_socio_success_poly",
  "comport_socio_child_poly_parent",
  "comport_socio_poly_cheat",
  "comport_socio_poly_relation",
  "discrimination_gender",
  "discrimination_gender_expression",
  "discrimination_ethnicity_culture",
  "discrimination_race",
  "discrimination_physical_appearance",
  "discrimination_religion",
  "discrimination_sexual_orientation",
  "discrimination_age",
  "discrimination_disability",
  "discrimination_language",
  "discrimination_other",
  "discrimination_never",
  "political_behaviour_turnout_prob",
  "political_behaviour_voted_2021",
  "political_behaviour_vote_choice_2021",
  "political_behaviour_vote_intent",
  "political_behaviour_vote_intent_certainty",
  "political_behaviour_prob_support_PLC",
  "political_behaviour_prob_support_PCC",
  "political_behaviour_prob_support_BQ",
  "political_behaviour_prob_support_PPC",
  "political_behaviour_prob_support_NPD",
  "political_behaviour_prob_support_PVC",
  "political_behaviour_irc_PLC",
  "political_behaviour_irc_PCC",
  "political_behaviour_irc_BQ",
  "political_behaviour_irc_PPC",
  "political_behaviour_irc_NPD",
  "political_behaviour_irc_PVC",
  "political_behaviour_left_right",
  "ai_trust_enough_disclosure",
  "ai_take_care_protect_personal_data",
  "attention_check_2_ok",
  "ai_government_use_numeric_data_public_good",
  "best_canadian_book",
  "best_canadian_album",
  "best_canadian_movie",
  "best_canadian_newspaper",
  "know_french_media_personality",
  "know_french_singer",
  "know_french_actor",
  "know_french_writer",
  "know_english_media_personality",
  "know_english_singer",
  "know_english_actor",
  "know_english_writer",
  "french_speaking_friends",
  "english_speaking_friends",
  "other_language_speaking_friends",
  "french_speaking_skills",
  "english_speaking_skills",
  "exp_1",
  "exp_2"
)

names_raw_codebook <-c(
  "genre",
  "orientation",
  "age",
  "age",
  "langue_maternelle",
  "occupation_1",
  "occupation_2",
  "occupation_3",
  "occupation_4",
  "occupation_5",
  "occupation_6",
  "occupation_7",
  "occupation_8",
  "occupation_9",
  "occupation_12",
  "occupation_13",
  "travail_emploi",
  "travail_domaine_1",
  "travail_domaine_2",
  "travail_domaine_3",
  "travail_domaine_4",
  "travail_domaine_5",
  "travail_domaine_6",
  "travail_domaine_7",
  "travail_domaine_8",
  "travail_domaine_9",
  "travail_domaine_10",
  "travail_domaine_11",
  "travail_heures",
  "teletravail_heures",
  "revenu",
  "percep_revenu",
  "education",
  "pays_origine",
  "origines_ethniques",
  "religion",
  "religiosite_1",
  "enfants",
  "enfants",
  "married",
  "married",
  "married",
  "poids",
  "taille",
  "code_postal",
  "travail_deplacement",
  "milieu_vie",
  "habitation",
  "province_",
  "pets",
  "act_physique",
  "freq_physique_",
  "transport",
  "car_model",
  "consumption",
  "coffee",
  "meat",
  "alcool_pref",
  "smoking",
  "cannabis",
  "act_hunting",
  "act_fishing",
  "act_motorized",
  "act_friends",
  "act_volunteer",
  "act_museum",
  "act_nature_1",
  "act_nature_2",
  "movie_pref",
  "style",
  "style_9_TEXT",
  "music_pref",
  "temps__cran__1",
  "temps__cran__2",
  "temps__cran__3",
  "temps__cran__4",
  "CSM_Comparison",
  "CSM_QA1_1",
  "CSM_QA1_2",
  "CSM_QA1_3",
  "CSM_QA2_1",
  "CSM_QA2_2",
  "CSM_QA2_3",
  "CSM_QA2_4",
  "CSM_QA2_5",
  "CSM_QA2_6",
  "CSM_QA2_7",
  "CSM_QA2_8",
  "CSM_QA2_9",
  "CSM_QA2_10",
  "CSM_QA2_11",
  "PHQ4_1",
  "PHQ4_2",
  "PHQ4_3",
  "PHQ4_4",
  "hsa_stress__vie",
  "maladies_1",
  "maladies_2",
  "maladies_3",
  "maladies_4",
  "maladies_5",
  "maladies_6",
  "maladies_7",
  "maladies_8",
  "maladies_9",
  "maladies_10",
  "maladies_11",
  "maladies_12",
  "maladies_13",
  "maladies_14",
  "maladies_15",
  "maladies_16",
  "maladies_17",
  "maladies_18",
  "maladies_19",
  "maladies_20",
  "maladies_21",
  "maladies_22",
  "maladies_23",
  "autogestion_1",
  "autogestion_2",
  "autogestion_3",
  "autogestion_4",
  "autogestion_5",
  "autogestion_6",
  "autogestion_7",
  "autogestion_8",
  "autogestion_9",
  "autogestion_10",
  "MSCS_1",
  "MSCS_2",
  "MSCS_3",
  "sommeil_1",
  "chronotype",
  "som_satisf__isi",
  "som_perturb",
  "alim_fruits__leg",
  "conso_freq",
  "conso_drogue__1",
  "conso_drogue__1",
  "conso_drogue__2",
  "conso_drogue__2",
  "conso_drogue__3",
  "conso_drogue__3",
  "act_physique_godin_1",
  "act_physique_godin_2",
  "act_physique_godin_3",
  "DemPsy_1",
  "DemPsy_2",
  "DemPsy_3",
  "DemPsy_4",
  "DemPsy_5",
  "DemPsy_6",
  "DemPsy_7",
  "DemPsy_8",
  "DemPsy_9",
  "DemPsy_10",
  "DemPsy_11",
  "DemPsy_12",
  "LatDec_1",
  "LatDec_2",
  "LatDec_3",
  "LatDec_4",
  "LatDec_5",
  "SoutColl_1",
  "SoutColl_2",
  "SoutColl_3",
  "SoutSup_1",
  "SoutSup_2",
  "SoutSup_3",
  "SoutSup_4",
  "SoutSup_5",
  "SoutSup_6",
  "SoutSup_7",
  "SoutSup_8",
  "quartier_domicile_1",
  "quartier_domicile_2",
  "quartier_domicile_3",
  "quartier_domicile_4",
  "quartier_domicile_5",
  "quartier_domicile_6",
  "quartier_domicile_7",
  "quartier_domicile_8",
  "quartier_domicile_9",
  "quartier_domicile_10",
  "quartier_opportunite",
  "quartier_satisf_1",
  "fournisseurs_sante_1",
  "fournisseurs_sante_2",
  "fournisseurs_sante_3",
  "fournisseurs_sante_4",
  "fournisseurs_sante_5",
  "sexual_concerns_1",
  "consult_sante",
  "consult_who_1",
  "consult_who_2",
  "consult_who_3",
  "consult_who_4",
  "consult_who_5",
  "consult_who_6",
  "consult_who_7",
  "consult_who_6_TEXT",
  "values_inventory_1",
  "values_inventory_2",
  "values_inventory_3",
  "values_inventory_4",
  "values_inventory_5",
  "values_inventory_6",
  "values_inventory_7",
  "values_inventory_8",
  "values_inventory_9",
  "values_inventory_10",
  "values_inventory_11",
  "perso_1",
  "perso_2",
  "perso_3",
  "perso_4",
  "perso_5",
  "perso_6",
  "perso_7",
  "perso_8",
  "perso_9",
  "perso_10",
  "climate_worry__1",
  "climate_worry__2",
  "climate_worry__3",
  "nb_friends_home_1",
  "nb_friends_home_2",
  "nb_friends_home_3",
  "nb_friends_home_4",
  "nb_friends_home_5",
  "nb_friends_dispo",
  "nb_friends_dispo_2",
  "poly_likert_1",
  "poly_likert_2",
  "poly_likert_3",
  "poly_rel",
  "discrimination_1",
  "discrimination_2",
  "discrimination_3",
  "discrimination_4",
  "discrimination_5",
  "discrimination_6",
  "discrimination_7",
  "discrimination_8",
  "discrimination_9",
  "discrimination_10",
  "discrimination_11",
  "discrimination_12",
  "turnout_2023_1",
  "turnout_2021",
  "vote_choice_2021",
  "vote_choice_today",
  "certainty_choice",
  "prob_parties_1",
  "prob_parties_2",
  "prob_parties_3",
  "prob_parties_4",
  "prob_parties_5",
  "prob_parties_6",
  "prob_parties_1",
  "prob_parties_2",
  "prob_parties_3",
  "prob_parties_4",
  "prob_parties_5",
  "prob_parties_6",
  "left_right_1",
  "issue_ai_data_1",
  "issue_ai_data_2_1",
  "issue_ai_data_2_2",
  "issue_ai_data_2_3",
  "issue_ai_data_2_4",
  "issue_ai_data_2_5",
  "issue_ai_data_3",
  "best_cad_1",
  "best_cad_2",
  "best_cad_3",
  "best_cad_4",
  "know_fre_1",
  "know_fre_2",
  "know_fre_3",
  "know_fre_4",
  "know_eng_1",
  "know_eng_2",
  "know_eng_3",
  "know_eng_4",
  "friends_1",
  "friends_2",
  "friends_3",
  "ling_1",
  "ling_2",
  "exp_1",
  "exp_2"
)

diff_clean_r_codebook <- setdiff(names_clean_r, names_clean_codebook)
print("Variables présentes dans data_clean R mais pas dans le codebook :")
print(diff_clean_r_codebook)

diff_clean_codebook_r <- setdiff(names_clean_codebook, names_clean_r)
print("Variables présentes dans le codebook mais pas dans data_clean R :")
print(diff_clean_codebook_r)

diff_raw_r_codebook <- setdiff(names_raw_r, names_raw_codebook)
print("Variables présentes dans data_raw R mais pas dans le codebook :")
print(diff_raw_r_codebook)

diff_raw_codebook_r <- setdiff(names_raw_codebook, names_raw_r)
print("Variables présentes dans le codebook mais pas dans data_raw R :")
print(diff_raw_codebook_r)
